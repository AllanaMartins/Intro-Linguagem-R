---
title: "Aula 1 - Introdução ao R"
author: "Vitor Rios"
date: "10 de outubro de 2017"
output:
  slidy_presentation:
    font_adjustment: + 1
    highlight: kate
  beamer_presentation:
    highlight: kate
---
# Bem vindos


## Cronograma
Dia 1  -  21/11 - Introdução e como usar o R e Rstudio, boas práticas de programação  
Dia 2  -  22/11 - Criando e e manipulando dados  
Dia 3  -  23/11 - Trabalhando com arquivos externos  
Dia 4  -  28/12 - Noções de programação  
Dia 5  -  05/12 - Gráficos  
Dia 6  -  06/12 - Análise exploratória e funções matemáticas  
Dia 7  -  07/12 - Análise exploratória e funções matemáticas  
Dia 8  -  12/12 - Análise estatística básica  
Dia 9  -  13/12 - Versionamento de código: noções de git   
Dia 10 -  14/12 - Programação para iniciantes, Função final  

Aulas: teoria (1 a 2 h) + prática (wiki do curso)
Avaliação: exercícios e constução de uma função (entrega 2 semanas após fim da disciplina)

Enviar exercícios para `cursolinguagemr@gmail.com`
'https://groups.google.com/forum/#!forum/linguagem-r-ufba'


# O que é o R?
- R é uma linguagem de programação voltada para análises estatísticas e manipulação de dados
- RStudio é um ambiente de desenvolvimento integrado (IDE) que extende as capacidades do R e facilita o uso
 
##Jeito R de ser
- Praticidade  
- Reprodutibilidade  
- Simplicidade (sim, você leu direito)  
- Cooperação

Ao fazer o tratamento e análise dos dados dentro do R, você não altera os dados originais, e pode reproduzir tudo, bastando ter o script e os dados originais. Não é necessário nem salvar os gráficos!


# Porque Usar R? 
- Uma vastidão de pacotes de análises prontas  

![CranTaskView](figuras/cranTaskView2.png)

***
* Além disso, o R tem **Interfaces amigáveis que não precisam de programação**  
    + RCommander <- fácil acesso às análises principais
    + Action <- análises integradas ao Excel
    + RStudio <-ambiente completo de programação  
  
* Possibilidade de programar suas próprias análises, de acordo com suas necessidades
* Integração com outros softwares
    + GIS
    + Git  **<-- Salvação da humanidade**
    + Excel
    + C++
    + Python
    + Esta aula foi feita em R no RStudio   
 
    

# Primeiros passos no R

## Abrir o RStudio
![](figuras/interfaceRStudio2.png) 

# No RStudio
##Vantagens do RStudio
Note que o RStudio muda automaticamente as cores do código. Isto é chamado `syntax highlighting`, e serve pra facilitar a leitura. O que cada cor quer dizer?

O Rstudio também insere automaticamente um `)`, `}` ou `]` quando você digita `(`, `{`, ou `[`, o que diminui a maior parte dos erros de digitação

Digite o comando abaixo na aba console, onde está o caractere  `>` , e depois tecle **enter**
```{r, echo = TRUE}
4 + 12
```
O resultado aparece logo abaixo, na própria aba, em cor diferente


#O R é uma calculadora completa, tente várias combinações. 
Qualquer texto após \# é ignorado pelo R
```{r echo=TRUE}
1 + 1  # soma
3 - 74 ## subtração
4 * 12 ## multiplicação
3 / 7 ## divisão
```

#O R também aceita comandos mais complicados
```{r, echo = TRUE}
  pi ^ 2 # potência
((4 * 7) + 45) / 2
```
O que está dentro dos parênteses é avaliado de dentro para fora, e o resultado é usado para a operação seguinte, e assim por diante

# Logaritmos, exponenciações, raízes
```{r, echo = TRUE}
log(10, base=2)
exp(1)
sqrt(2)
```


# Funções
Quando temos um nome seguido de parêntese com alguma coisa dentro, temos uma **função**  
Função é um conjunto de comandos que faz uma operação em um objeto  
`sqrt(x)` calcula a raiz quadrada de x  
Funções podem ter opçoes, chamadas argumentos
```{r, echo=TRUE, eval = FALSE}
log(10, base=2)
```
calcula o logaritmo de 10 na base 2  

Quase tudo que você vai usar no R são funções

Muito cuidado com a digitação: para o R, maiúsculas e minúsculas são diferentes, e um espaço no meio da palavra atrapalha tudo

**O R é burro, qualquer erro de digitação faz com que ele não encontre o que você procura**

#Ajuda das funções
você pode pedir socorro ao R em qualquer momento
```{r, echo=TRUE, eval = FALSE}
?log()
?exp()
?plot()
help(library)
```
As funções geralmente vem em conjuntos especializados voltados para alguma análise, chamados de _pacotes_

#Outros lugares para pedir ajuda
Quase todos os problemas que você tem com R, alguém já teve e resolveu

Google <- busque por "R manova" ou "R phylogenetics" ou "R cluster analysis", etc.  
[Stack Overflow](https://stackoverflow.com/) <- geralmente é o primeiro resultado do Google  

Quando o R der erro, copie a mensagem e cole no Google!

#CRAN
o _Comprehensive R Archive Network_ é o repositório central oficial de pacotes do R. Para instalar um pacote do CRAN, usamos o comando install.packages("nome",repositório), ou no RStudio, clicamos em `Install` na aba `Packages`

```{r, echo = TRUE,eval=FALSE}
install.packages("igraph", repos=http://nbcgib.uesc.br/mirrors/cran/)
```

  ![](figuras/abaPackages.png) 


#Para usar um pacote

```{r echo=TRUE}
library(igraph)

```
agora as funções do `igraph` estão disponíveis para serem usadas

#Dados e variáveis
##R é uma linguagem de manipulação de objetos
No R, podemos criar caixas para guardar coisas que iremos usar depois, que chamamos de `variáveis`, ou `objetos`  
Para isso usamos o sinal `=` ou `<-`.   Pense na expressão `a = 10` como `o objeto a recebe o valor 10`

`<-` existe por motivos de compatibilidade com teclados que nao possuíam `=` (lá dos tempos jurássicos da computação). Use `=`  

```{r, echo=TRUE}
pote.de.sorvete = "feijão"
```

Na linha acima o R interpreta o que está dentro das apas como texto, e guarda esse valor dentro de um pedaço da memória que recebe o nome `pote.de.sorvete`. 

O nome das variáveis não deve conter espaços, acentos,ou caracteres especiais como ç, ~, !, ?, /, |, +, *, ^,`,`,'     
***
Ao digitarmos `pote.de.sorvete` no console, o R nos mostra o que está guardado nesse pedaço de memória

```{r, echo=TRUE}
pote.de.sorvete
```

#Escolha nomes que façam sentido para suas variáveis
Lembre que você vai ter de ler seus códigos depois, e advinhar o que você quis dizer com `a`, `aa`, `x`, `X`, `a7589`, `MyVar` e outras bizarrices que pareciam fazer sentido.

Aproveite que o RStudio tem autocompletar!

Para trocar o que está dentro dessa variável, basta usar o _=_ novamente
```{r, echo=TRUE}
pote.de.sorvete = "sorvete"
pote.de.sorvete

```
Porque o código baixo nao funciona?
```{r, echo=TRUE,eval=FALSE}
pote .de.sorvete = "chuchu"
```

***
Para ver o que tem na memória do R, use o comando `ls()`
```{r}
ls()
```

No RStudio, podemos ver o conteúdo dos objetos que criamos na aba "Environment"  

![](figuras/abaEnvironment.png) 

#Variáveis também podem guardar conjuntos de dados
Chamamos estas variáveis de `vector` ou `vetor`. Criamos elas com a função `combine`, `c()`
```{r, echo=TRUE, tidy=TRUE}
geladeira = c("sorvete","cebola","agua", "miojo","macarrão","pacote.de.ketchup")
geladeira
```

Vetores só guardam objetos iguais: ou texto, ou números, nunca os dois juntos  
Veja o que as funções `seq()` e `rep()` fazem!


#Vetor é a unidade básica do R
Quase todas as funções do R são baseadas em manipulação de vetores
```{r, echo=TRUE}
peso.real = c(100, 45, 77, 60)
peso.no.perfil = c(70, 50, 60, 55)
quilos.omitidos = peso.real - peso.no.perfil
quilos.omitidos

```

***
Ao somar, multiplicar, subtrair ou dividir vetores, o R pega os valores na mesma posição e faz a operação em questão

**regra da reciclagem** Quando um vetor é menor que o outro, o R repete o vetor menor até completar o maior

```{r, echo=TRUE}
peso.real = c(100, 45, 77, 60, 50, 77.5)
ganho.apos.almoco = c(2, 5.3)
peso.gordo= peso.real + ganho.apos.almoco
peso.gordo
```

Sempre confira o tamanho dos seus vetores!

#Tamanho e conteúdo dos vetores
Função `length()` retorna o tamanho do vetor
```{r, echo=TRUE}
peso.real = c(100, 45, 77, 60, 50, 77.5)
length(peso.real)
```
Para acessar o elemento `i` do vetor, use `nome[i]`
```{r, echo=TRUE}
peso.real = c(100, 45, 77, 60, 50, 77.5)
peso.real[3]
```
***
#Dataframes
Dataframes são o formato de tabela mais comum do R. No dataframe você pode ter colunas com tipos de dados diferentes, como numérico e texto.  
Para criar o dataframe, podemos unir 2 ou mais vetores usando a função `data.frame()`

```{r}
vetor1=LETTERS
vetor2=1:26
dados=data.frame(x=vetor1,y=vetor2)
class(dados)
```

As colunas do dataframe podem ter nomes:
```{r}
vetor3=letters
vetor4=26:1
nomesColunas= c("Letras","Numeros")
dadosNomeados=data.frame(vetor3,y=vetor4)
colnames(dadosNomeados) = nomesColunas
head(dadosNomeados)
```
#Acessando dados no dataframe
Existem dois jeitos principais de acessar dados em um dataframe: colchetes `[]` ou cifrão `$`  
Isto se chama `indexação`:   
dataframe[linha, coluna]
```{r}
dadosNomeados[3,2]
```
dataframe$nomeDaColuna
```{r}
dadosNomeados$Numeros
```
você também pode usar ambas notações:
dataframe$nomeDaColuna[linha]
```{r}
dadosNomeados$Numeros[4]
```

#Indexação
O colchete aceita também vetores como índice, incluindo vetores lógicos (sequencias de TRUE / FALSE)

```{r}
Idade = c(3.0, 4.0, 5.0, 6.0, 8.0, 9.0, 10.0, 11.0, 12.0, 14.0, 15.0, 16.0, 17.0)

Idade[c(5, 4, 1, 10, 12)]

Idade > 6 # retorna um vetor lógico dizendo se cada elemento de Idade é maior que 6

Idade[ Idade> 6 ] #retorna um vetor com todos os elementos de Idade maiores que 6
```

#Matrix
Matrizes são tabelas cujas colunas possuem apenas um tipo de dado, seja numerico ou texto. Podem ser criadas com as funções `matrix`, `cbind`, ou `rbind()`


##Array
Array são estruturas de dados com mais de duas dimensões. pensando no vetor como uma linha, uma dataframe seria uma folha de papel, e o array com 3 dimensões seria o equivalente a um caderno, várias folhas empilhadas. Podemos também ter arrays com 4 ou cinco dimensões, que podemos fazer analogia com uma prateleira de cadernos, uma estante com várias prateleiras, e assim por diante.




